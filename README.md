# MIDI-Sender
サクッとMIDIデータを送るためのPythonスクリプト。

### 必要なもの
* Python 3.7.0以上の実行環境
  * python-rtmidi<br>https://github.com/SpotlightKid/python-rtmidi
  * mido<br>https://github.com/olemb/mido
  * schedule<br>https://github.com/dbader/schedule

### 概要
Pythonで手軽にMIDIデータを送れます。自分用なので超手抜きです。

1. 入力MIDIファイルからMIDIイベント群を読み込みます
2. 全MIDIイベントについて、デルタタイムから送信時刻を算出します
3. t秒間隔でループを回します。ループごとに現在時刻を取得し、MIDIシーケンス送信開始時刻からの経過時間を計算します<br>
（つまり、経過時間はt秒ずつ増えていきます）
4. 送信時刻 <= 経過時間 となるMIDIイベントを送信します
5. 全MIDIイベントを送信するまで3.〜4.を繰り返します

MIDIイベントを送信するプログラム例として、デルタタイム分だけスリープを実行するサンプルをよく見かけます。しかし、この方法だと処理時間の遅延が蓄積し続けてしまいます。

一方、このプログラムのように周期t秒でループを回す方法の場合、処理時間の遅延を最大t秒に抑えることができ、遅延の蓄積も起こりません。tの値はコマンドライン引数で任意の値を与えられます。

※ 実行環境によっては精密にt秒間隔でループ処理ができないこともあります。

### 実行例
周期100[μsec]でループを実行。
```
$ python3 src/main.py -f input/soramotoberuhazu.mid -i 0.0001
Do you want to create a virtual MIDI output port? (y/N) n
Available MIDI ports:

[0] Steinberg UR22 Port1

Select MIDI output port (Control-C to exit): 0
MIDI Out : [255, 3, 0], @2018-10-27 23:30:17.993568
MIDI Out : [144, 55, 96], @2018-10-27 23:30:19.243380
MIDI Out : [128, 55, 96], @2018-10-27 23:30:19.493410
MIDI Out : [144, 60, 96], @2018-10-27 23:30:19.493465
MIDI Out : [128, 60, 96], @2018-10-27 23:30:19.743353
MIDI Out : [144, 62, 96], @2018-10-27 23:30:19.743426
MIDI Out : [128, 62, 96], @2018-10-27 23:30:19.993455
MIDI Out : [144, 64, 96], @2018-10-27 23:30:19.993564
MIDI Out : [128, 64, 96], @2018-10-27 23:30:20.493390
MIDI Out : [144, 64, 96], @2018-10-27 23:30:20.493496
MIDI Out : [128, 64, 96], @2018-10-27 23:30:20.993446
MIDI Out : [144, 62, 96], @2018-10-27 23:30:20.993519
MIDI Out : [128, 62, 96], @2018-10-27 23:30:21.243355
MIDI Out : [144, 64, 96], @2018-10-27 23:30:21.243464
MIDI Out : [128, 64, 96], @2018-10-27 23:30:21.493390
MIDI Out : [144, 65, 96], @2018-10-27 23:30:21.493465
MIDI Out : [128, 65, 96], @2018-10-27 23:30:21.993451
MIDI Out : [144, 64, 96], @2018-10-27 23:30:21.993525
MIDI Out : [128, 64, 96], @2018-10-27 23:30:22.493415
MIDI Out : [144, 60, 96], @2018-10-27 23:30:22.743417
MIDI Out : [128, 60, 96], @2018-10-27 23:30:22.993425
MIDI Out : [144, 60, 96], @2018-10-27 23:30:22.993499
MIDI Out : [128, 60, 96], @2018-10-27 23:30:23.993422
MIDI Out : [144, 69, 96], @2018-10-27 23:30:23.993487
MIDI Out : [128, 69, 96], @2018-10-27 23:30:24.493426
MIDI Out : [144, 69, 96], @2018-10-27 23:30:24.493495
MIDI Out : [128, 69, 96], @2018-10-27 23:30:24.993449
MIDI Out : [144, 59, 96], @2018-10-27 23:30:24.993516
MIDI Out : [128, 59, 96], @2018-10-27 23:30:25.243373
MIDI Out : [144, 60, 96], @2018-10-27 23:30:25.243448
MIDI Out : [128, 60, 96], @2018-10-27 23:30:25.493349
MIDI Out : [144, 62, 96], @2018-10-27 23:30:25.493456
MIDI Out : [128, 62, 96], @2018-10-27 23:30:25.743395
MIDI Out : [144, 69, 96], @2018-10-27 23:30:25.743449
MIDI Out : [128, 69, 96], @2018-10-27 23:30:25.993359
MIDI Out : [144, 69, 96], @2018-10-27 23:30:25.993433
MIDI Out : [128, 69, 96], @2018-10-27 23:30:26.243443
MIDI Out : [144, 67, 96], @2018-10-27 23:30:26.243519
MIDI Out : [128, 67, 96], @2018-10-27 23:30:26.493389
MIDI Out : [144, 64, 96], @2018-10-27 23:30:26.493475
MIDI Out : [128, 64, 96], @2018-10-27 23:30:26.743461
MIDI Out : [144, 67, 96], @2018-10-27 23:30:26.743530
MIDI Out : [128, 67, 96], @2018-10-27 23:30:27.243441
MIDI Out : [144, 65, 96], @2018-10-27 23:30:27.243515
MIDI Out : [128, 65, 96], @2018-10-27 23:30:27.743411
MIDI Out : [144, 67, 96], @2018-10-27 23:30:27.743469
MIDI Out : [128, 67, 96], @2018-10-27 23:30:27.993414
MIDI Out : [255, 47, 0], @2018-10-27 23:30:27.993510
```
